var lang = getCookie("lang") || "en";let langNum = 0;switch (lang) {case "en":    langNum = 0;    break;case "de":    langNum = 1;    break;case "fr":    langNum = 2;    break;case "cn":    langNum = 3;    break;}var MitarbeiterID = getCookie("MitarbeiterID") || 0;var Rolle = getCookie("Rolle") || 5;//1:老板, 2:经理, 3:仓库员, 4:会计, 5:普通员工var Username = getCookie("Username") || "";var Vorname = getCookie("Vorname") || "";var Nachname = getCookie("Nachname") || "";var Email = getCookie("Email") || "";if (window.location.href.indexOf("Login") < 0 && MitarbeiterID == 0) {    deleteCookies();}var MitarbeiterInt1Arr = new Array();MitarbeiterInt1Arr.push(["Boss", "Chef", "Patron", "老板", 1]);MitarbeiterInt1Arr.push(["Manager", "Manager", "Gestionnaire", "经理", 2]);MitarbeiterInt1Arr.push(["Warehouse Clerk", "Lagerarbeiter", "Magasinier", "仓库员", 3]);MitarbeiterInt1Arr.push(["Accountant", "Buchhalter", "Comptable", "会计", 4]);MitarbeiterInt1Arr.push(["General Staff", "Allgemeines Personal", "Personnel général", "普通员工", 9]);var KundenInt1Arr = new Array();KundenInt1Arr.push(["Regular User", "Normaler Kunden", "Utilisateur normal", "普通用户", 1]);KundenInt1Arr.push(["VIP User", "VIP-Kunden", "Utilisateur VIP", "VIP用户", 2]);var ProduktTopArr = new Array();ProduktTopArr.push(["Product Management", "Produktverwaltung", "Gestion des produits", "产品管理", "/ProduktVerwalten"]);ProduktTopArr.push(["Product Type", "Produkttyp", "Type de produit", "产品类型", "/ProduktKatalog"]);ProduktTopArr.push(["Product Attribute", "Produkteigenschaft", "Attribut du produit", "产品属性", "/ProduktEigenschaft"]);ProduktTopArr.push(["Manufacturer", "Hersteller", "Fabricant", "生产厂家", "/ProduktHersteller"]);var BestellungStatusArr = new Array();BestellungStatusArr.push(["Unbezahlt bestellt", "Unpaid order", "Commande non payée", "下单未付款", 1]);BestellungStatusArr.push(["Bezahlt bestellt", "Paid order", "Commande payée", "下单已付款", 2]);BestellungStatusArr.push(["uploaded", "uploaded", "expédié", "已上传运单", 3]);BestellungStatusArr.push(["reclamation", "reclamation", "réclamation", "进入售后", 5]);BestellungStatusArr.push(["handling", "handling", "en cours de traitement", "待处理", 6]);BestellungStatusArr.push(["canceled", "canceled", "annulé", "取消", 8]);BestellungStatusArr.push(["done", "done", "terminé", "完成", 9]);var BestellungInt1Arr = new Array();BestellungInt1Arr.push(["Invoice", "Rechnung", "Facture", "发票", 1]);BestellungInt1Arr.push(["Paypal", "Paypal", "Paypal", "Paypal", 2]);BestellungInt1Arr.push(["Stripe", "Stripe", "Stripe", "Stripe", 3]);var ProduktKatalogArr = new Array();var ProduktEigenschaftArr = new Array();var ProduktHerstellerArr = new Array();var MitarbeiterArr = new Array();var ProduktEinzelArr = new Array();var ProduktListeArr = new Array();var VertreterListeArr = new Array();var LagerDefStatusArr=new Array();LagerDefStatusArr.push(new LagerDefStatusObj(1, "Nicht auf Lager", "Not in stock", "Pas en stock", "未入库"));LagerDefStatusArr.push(new LagerDefStatusObj(2, "Auf Lager", "In stock", "En stock", "已入库"));LagerDefStatusArr.push(new LagerDefStatusObj(3, "Reserviert", "Reserved", "Réservé", "已预订"));//LagerDefStatusArr.push(new LagerDefStatusObj(6, "Ausstehend", "Pending", "En attente", "待处理"));//LagerDefStatusArr.push(new LagerDefStatusObj(7, "Bestellt", "Ordered", "Commandé", "已出单"));LagerDefStatusArr.push(new LagerDefStatusObj(8, "Verschrottet", "Scrapped", "Mis au rebut", "报废"));LagerDefStatusArr.push(new LagerDefStatusObj(9, "Aus", "Out of stock", "Épuisé", "出库"));var ProduktTopText = "<ul class='menu-nav'>";for(var i=0; i<ProduktTopArr.length; i++){	ProduktTopText +=   "<li class='menu-item' data-menu-toggle='click' id='menu-item-"+i+"' onclick='window.location.href=\""+ProduktTopArr[i][4]+"\"'>" +						"<a class='menu-link menu-toggle'>" +						"<span class='menu-text'>" + ProduktTopArr[i][langNum] + "</span>" +						"<i class='menu-arrow'></i>" +						"</a></li>";}ProduktTopText +=  "</ul>";function languageObj(id, en, de, fr, cn) {    this.id = id;    this.en = en;    this.de = de;    this.fr = fr;    this.cn = cn;}function getKatalogListe() {	ProduktKatalogArr = new Array();		$.ajax({		type: "POST",		url: "/General_Select",		contentType: 'application/x-www-form-urlencoded',		async: false, //此处为同步		data: {			SQL_TXT: escape("SELECT * FROM `laaver`.produkt_katalog AS mainTable")		},		success: function (response) {			if (response.results && Array.isArray(response.results)) {				                response.results.forEach(function (item) {					let obj = {};					for (let key in item) {						let val = item[key];						// 1. BIT 类型字段：Buffer 转 0/1						if (val && typeof val === 'object' && val.type === 'Buffer' && Array.isArray(val.data)) {							obj[key] = val.data[0] ? 1 : 0;						}						// 2. 包含 "Datum" 的字段						else if (key.includes("Datum")) {							if (val === null || val === undefined) {								obj[key] = ""; // null 或 undefined → 空字符串							} else {								try {									obj[key] = val.toString().substring(0, 10); // 取 YYYY-MM-DD								} catch (e) {									obj[key] = ""; // 容错								}							}						}						// 3. 其他字段：正常赋值						else {							obj[key] = val;						}					}					ProduktKatalogArr.push(obj);				});            }		}	});}function getMitarbeiterListe() {	MitarbeiterArr = new Array();		$.ajax({		type: "POST",		url: "/General_Select",		contentType: 'application/x-www-form-urlencoded',		async: false, //此处为同步		data: {			SQL_TXT: escape("SELECT * FROM `laaver`.Mitarbeiter AS mainTable")		},		success: function (response) {			if (response.results && Array.isArray(response.results)) {				                response.results.forEach(function (item) {					let obj = {};					for (let key in item) {						let val = item[key];						// 1. BIT 类型字段：Buffer 转 0/1						if (val && typeof val === 'object' && val.type === 'Buffer' && Array.isArray(val.data)) {							obj[key] = val.data[0] ? 1 : 0;						}						// 2. 包含 "Datum" 的字段						else if (key.includes("Datum")) {							if (val === null || val === undefined) {								obj[key] = ""; // null 或 undefined → 空字符串							} else {								try {									obj[key] = val.toString().substring(0, 10); // 取 YYYY-MM-DD								} catch (e) {									obj[key] = ""; // 容错								}							}						}						// 3. 其他字段：正常赋值						else {							obj[key] = val;						}					}					MitarbeiterArr.push(obj);				});            }		}	});}function getProduktListe() {	ProduktListeArr = new Array();		$.ajax({		type: "POST",		url: "/General_Select",		contentType: 'application/x-www-form-urlencoded',		async: false, //此处为同步		data: {			SQL_TXT: escape("SELECT * FROM laaver.produkt")		},		success: function (response) {			if (response.results && Array.isArray(response.results)) {				                response.results.forEach(function (item) {					let obj = {};					for (let key in item) {						let val = item[key];						// 1. BIT 类型字段：Buffer 转 0/1						if (val && typeof val === 'object' && val.type === 'Buffer' && Array.isArray(val.data)) {							obj[key] = val.data[0] ? 1 : 0;						}						// 2. 包含 "Datum" 的字段						else if (key.includes("Datum")) {							if (val === null || val === undefined) {								obj[key] = ""; // null 或 undefined → 空字符串							} else {								try {									obj[key] = val.toString().substring(0, 10); // 取 YYYY-MM-DD								} catch (e) {									obj[key] = ""; // 容错								}							}						}						// 3. 其他字段：正常赋值						else {							obj[key] = val;						}					}					ProduktListeArr.push(obj);				});            }		}	});}function getVertreterListe() {	VertreterListeArr = new Array();		$.ajax({		type: "POST",		url: "/General_Select",		contentType: 'application/x-www-form-urlencoded',		async: false, //此处为同步		data: {			SQL_TXT: escape("SELECT * FROM laaver.Vertreter")		},		success: function (response) {			if (response.results && Array.isArray(response.results)) {				                response.results.forEach(function (item) {					let obj = {};					for (let key in item) {						let val = item[key];						// 1. BIT 类型字段：Buffer 转 0/1						if (val && typeof val === 'object' && val.type === 'Buffer' && Array.isArray(val.data)) {							obj[key] = val.data[0] ? 1 : 0;						}						// 2. 包含 "Datum" 的字段						else if (key.includes("Datum")) {							if (val === null || val === undefined) {								obj[key] = ""; // null 或 undefined → 空字符串							} else {								try {									obj[key] = val.toString().substring(0, 10); // 取 YYYY-MM-DD								} catch (e) {									obj[key] = ""; // 容错								}							}						}						// 3. 其他字段：正常赋值						else {							obj[key] = val;						}					}					VertreterListeArr.push(obj);				});            }		}	});}function getProduktEinzelListe() {	ProduktEinzelArr = new Array();		$.ajax({		type: "POST",		url: "/General_Select",		contentType: 'application/x-www-form-urlencoded',		async: false, //此处为同步		data: {			SQL_TXT: escape("SELECT P.ProduktString2, P.ProduktString3, P.ProduktString4, P.ProduktString5, P.ProduktString16, P.ProduktString13, "+							"  (SELECT GROUP_CONCAT(CONCAT(pa.ProduktAttributeString1, '%3A%20', REPLACE(pa.ProduktAttributeString2, ' ', '%20')) SEPARATOR '%3Cbr%2F%3E') "+							"	 FROM laaver.produkt_attribute pa "+							"	 WHERE FIND_IN_SET(pa.prIDX, REPLACE(PE.ProduktEinzelString1, ' ', '')) > 0"+							"  ) AS AttributeResult,"+							"  P.prIDX AS Produkt_prIDX,"+							"  COALESCE((SELECT PE2.ProduktEinzelInt1 FROM laaver.Produkt_Einzel AS PE2 ORDER BY PE2.ProduktEinzelInt1 DESC LIMIT 1), 0) AS ProduktEinzelInt1,"+							"  COALESCE((SELECT PE2.ProduktEinzelFloat1 FROM laaver.Produkt_Einzel AS PE2 ORDER BY PE2.ProduktEinzelInt1 DESC LIMIT 1), 0.0) AS ProduktEinzelFloat1, "+							"  PE.*"+							"FROM laaver.produkt_einzel AS PE "+							"INNER JOIN laaver.produkt AS P ON P.prIDX=PE.frIDX "+							"WHERE PE.ProduktEinzelBIT1 = 1 ORDER BY P.prIDX, AttributeResult ")		},		success: function (response) {			if (response.results && Array.isArray(response.results)) {				                response.results.forEach(function (item) {					let obj = {};					for (let key in item) {						let val = item[key];						// 1. BIT 类型字段：Buffer 转 0/1						if (val && typeof val === 'object' && val.type === 'Buffer' && Array.isArray(val.data)) {							obj[key] = val.data[0] ? 1 : 0;						}						// 2. 包含 "Datum" 的字段						else if (key.includes("Datum")) {							if (val === null || val === undefined) {								obj[key] = ""; // null 或 undefined → 空字符串							} else {								try {									obj[key] = val.toString().substring(0, 10); // 取 YYYY-MM-DD								} catch (e) {									obj[key] = ""; // 容错								}							}						}						// 3. 其他字段：正常赋值						else {							obj[key] = val;						}					}					ProduktEinzelArr.push(obj);				});            }		}	});}function applyLanguageInnerHTML() {    languageInnerHTMLArr.forEach(function(item) {        var element = document.getElementById(item.id);        if (element) {            var text = item[lang];            if (text !== undefined) {                element.innerHTML = text;            }        }    });}function applyLanguagePlaceholder() {    languagePlaceholderArr.forEach(function(item) {        var element = document.getElementById(item.id);        if (element) {            var text = item[lang];            if (text !== undefined) {                element.placeholder = text;            }        }    });}function applyLanguageValue() {    languageValueArr.forEach(function(item) {        var element = document.getElementById(item.id);        if (element) {            var text = item[lang];            if (text !== undefined) {                element.value = text;            }        }    });}function setCookie(name, value, days) {    const d = new Date();    d.setTime(d.getTime() + (days * 24 * 60 * 60 * 1000));    const expires = "expires=" + d.toUTCString();    document.cookie = name + "=" + encodeURIComponent(value) + ";" + expires + ";path=/";}function getCookie(name) {    const nameEQ = name + "=";    const cookies = document.cookie.split(';');    for (let i = 0; i < cookies.length; i++) {        let c = cookies[i].trim();        if (c.indexOf(nameEQ) === 0) {            return decodeURIComponent(c.substring(nameEQ.length));        }    }    return null;}function deleteCookies() {    const cookies = document.cookie.split(";");    for (let i = 0; i < cookies.length; i++) {        const cookieName = cookies[i].split("=")[0].trim();        document.cookie = cookieName + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";    }    window.location.href = "/Login";}function compare(p) {    return function(m, n) {        var a = m[p];        var b = n[p];        return a - b;        //升序    }}function compareDESC(p) {    return function(m, n) {        var a = m[p];        var b = n[p];        return b - a;        //降序    }}function showLoadingDiv() {    if (document.getElementById("loadingDiv"))        document.getElementById("loadingDiv").style.display = "block";}function hideLoadingDiv() {    if (document.getElementById("loadingDiv"))        document.getElementById("loadingDiv").style.display = "none";}function getFormattedNow() {    const now = new Date();    const year = now.getFullYear();    const month = String(now.getMonth() + 1).padStart(2, '0');    // 月份从0开始      const day = String(now.getDate()).padStart(2, '0');    const hours = String(now.getHours()).padStart(2, '0');    const minutes = String(now.getMinutes()).padStart(2, '0');    return `${year}-${month}-${day} ${hours}:${minutes}`;}function getRolleName(value) {    var txt = "";    for (var i = 0; i < MitarbeiterInt1Arr.length; i++) {        if (MitarbeiterInt1Arr[i][4] == value) {            txt = MitarbeiterInt1Arr[i][langNum];        }    }    return txt;}function getProduktKatalog(id){	var txt = "";	for(var i=0; i<ProduktKatalogArr.length; i++){		if(ProduktKatalogArr[i].prIDX==id){			txt = unescape(ProduktKatalogArr[i].ProduktKatalogString1);			break;		}	}	return txt;}function getProduktEigenschaft(id){	var txt = "";	for(var i=0; i<ProduktEigenschaftArr.length; i++){		if(ProduktEigenschaftArr[i].prIDX==id){			txt = unescape(ProduktEigenschaftArr[i].ProduktEigenschaftString1);			break;		}	}	return txt;}function getProduktHersteller(id){	var txt = "";	for(var i=0; i<ProduktHerstellerArr.length; i++){		if(ProduktHerstellerArr[i].prIDX==id){			txt = unescape(ProduktHerstellerArr[i].ProduktHerstellerString1);			break;		}	}	return txt;}function getMitarbeiterName(prIDX){	var txt="";	for(var i=0; i<MitarbeiterArr.length; i++){		if(MitarbeiterArr[i].prIDX==prIDX){			txt = unescape(MitarbeiterArr[i].MitarbeiterString1+" "+MitarbeiterArr[i].MitarbeiterString2);		}	}	return txt;}function isValidEmail(email) {  var regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;  return regex.test(email);}function askForSure() {	var alertTXT = "";	switch (langNum) {		case 0: alertTXT = "Are you sure?"; break;       // 英语			case 1: alertTXT = "Sind Sie sicher?"; break;    // 德语			case 2: alertTXT = "Êtes-vous sûr ?"; break;     // 法语		case 3: alertTXT = "确定吗？"; break;             // 中文		default: alertTXT = "Are you sure?"; break;      // 默认英文	}	return confirm(alertTXT);}function chooseFileIcon(name){	switch(name){		case "doc": return "doc"; break;		case "docx": return "doc"; break;		case "xls": return "csv"; break;		case "xlsx": return "csv"; break;		case "csv": return "csv"; break;		case "ppt": return "xml"; break;		case "xml": return "xml"; break;		case "jpg": return "jpg"; break;		case "jpeg": return "jpg"; break;		case "png": return "jpg"; break;		case "ico": return "jpg"; break;		case "pdf": return "pdf"; break;		default: return "html"; break;	}}function getLagerStatusName(id){	if(id!="" && LagerDefStatusArr.length>0){		for(var i=0; i<LagerDefStatusArr.length; i++){			if(LagerDefStatusArr[i].Index==id){				var txt="";				eval("txt=unescape(LagerDefStatusArr[i].Name"+parseInt(langNum+1)+");");				return txt;				break;			}		}	}}function getProduktEinzelListeName(id){	if(id!="" && ProduktEinzelArr.length>0){		for(var i=0; i<ProduktEinzelArr.length; i++){			if(ProduktEinzelArr[i].prIDX==id){				var txt="";				txt=unescape(ProduktEinzelArr[i].ProduktString2+ " | "+ProduktEinzelArr[i].AttributeResult).replace(/<br\/>/ig," - ");				return txt;				break;			}		}	}}function LagerDefStatusObj(Index,Name1,Name2,Name3,Name4){   this.Index=Index;   this.Name1=Name1;   this.Name2=Name2;   this.Name3=Name3;   this.Name4=Name4;}function getBestellungStatusName(id){	if(id!="" && BestellungStatusArr.length>0){		for(var i=0; i<BestellungStatusArr.length; i++){			if(BestellungStatusArr[i][4]==id){				return unescape(BestellungStatusArr[i][langNum]);				break;			}		}	}}function getVertreterName(prIDX){	if(prIDX!="" && VertreterListeArr.length>0){		for(var i=0; i<VertreterListeArr.length; i++){			if(VertreterListeArr[i].prIDX==prIDX){				return unescape(VertreterListeArr[i].VertreterString1);				break;			}		}	}	return "";}//removeOptions('selectElement')function removeOptions(id) {   let selectElement = document.getElementById(id);   var i, L = selectElement.options.length - 1;   for(i = L; i >= 0; i--) {      selectElement.remove(i);   }}//removeOptionsExceptFirst('selectElement')function removeOptionsExceptFirst(id) {   let selectElement = document.getElementById(id);   var i, L = selectElement.options.length - 1;   for(i = L; i >= 1; i--) {      selectElement.remove(i);   }}//selectElement('elementID', '11')function selectElement(id, valueToSelect) {        let element = document.getElementById(id);    element.value = valueToSelect;}